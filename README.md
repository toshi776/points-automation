## プロジェクト概要

- **目的**: ポイントサイト／アフィリエイト案件の情報を自動取得し、規約遵守した形でXなどのSNSに投稿するワークフローを構築する。
- **マネタイズ**: ASPやポイントサイトの成果報酬。SNS投稿が許可されている案件のみを対象にし、PR/広告表記を徹底する。

## 現在の仕様整理

1. **入力ソース**
   - メイン: モッピー、ハピタス、ポイントインカム等のメールマガジン。専用メールアドレス（Gmail API/IMAP）で受信。
   - 将来拡張: 各ポイントサイトをPlaywright/Puppeteerなどで巡回し、案件一覧をクロール。

2. **処理パイプライン**
   - 受信メールを解析し、案件名・報酬・条件・期限・SNS投稿可否などを抽出。
   - 報酬額や難易度などで「魅力度スコア」を算出し、構造化データベース（例: SQLite/Notion/スプレッドシート）に保存。
   - X投稿向けテンプレ＋PR表記を生成し、スパム判定を避けるため文面を都度変化させる。

3. **投稿フロー**
   - 承認済み案件をキューに投入し、X API (OAuth2 Bot) を使ってレート制御しながら投稿。
   - ASPトラッキングリンクを自動差し込みし、投稿ログと成果ログを記録。

4. **コンプライアンスと安全性**
   - 各ASP/案件のSNS投稿ルールをチェックし、禁止案件は除外。
   - Xの自動化・スパムポリシー遵守（投稿間隔、重複文言回避、PR表記）。
   - 投稿内容・素材はブランドが許可する範囲内で利用し、監査ログを保持。

## 次のアクション

1. 対象ポイントサイトのメール配信登録と受信テスト。
2. Gmail API/IMAP連携を設定し、ラベルやフィルタで案件メールを仕分け。
3. メール解析PoC（LLM＋ルールベース）を作成し、魅力度スコアと投稿文生成を確立。
4. 投稿キューとスケジューラを実装し、X API連携で自動投稿を実現。

## Yahooメール疎通スクリプト

- ルート直下の `.env` に `ID`（または `MAIL_ADDRESS`）、`MAIL_ADDRESS`、`PASSWORD` を設定する。必要に応じて `IMAP_HOST/PORT` や `SMTP_HOST/PORT` でホスト情報を上書きできる。
- IMAPで最新メールの概要を取得する:

  ```bash
  python3 mail_client.py fetch --folder INBOX --limit 5
  ```

- SMTPでテストメールを送信する:

  ```bash
  python3 mail_client.py send-test --to your@example.com
  ```

  `--to` を省略すると `.env` の `MAIL_ADDRESS` 宛に送信される。
